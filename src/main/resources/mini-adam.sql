DROP DATABASE IF EXISTS qqadam;
CREATE DATABASE qqadam DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci;
USE qqadam;

CREATE TABLE CAMPAIGNS (
  CAM_ID BIGINT NOT NULL AUTO_INCREMENT,
  CAM_NAME VARCHAR(256) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
  PRIMARY KEY(CAM_ID)
)
ENGINE=InnoDB;

CREATE TABLE ADSETS (
  ADS_ID BIGINT NOT NULL AUTO_INCREMENT,
  ADS_NAME VARCHAR(256) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
  CAM_ID BIGINT NULL,
  PRIMARY KEY(ADS_ID),
  INDEX ADSET_FKIndex1(CAM_ID),
  FOREIGN KEY(CAM_ID)
    REFERENCES CAMPAIGNS(CAM_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
)
ENGINE=InnoDB;

CREATE TABLE ADS (
  AD_ID BIGINT NOT NULL AUTO_INCREMENT,
  AD_NAME VARCHAR(256) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL,
  ADS_ID BIGINT NULL,
  PRIMARY KEY(AD_ID),
  INDEX AD_FKIndex1(ADS_ID),
  FOREIGN KEY(ADS_ID)
    REFERENCES ADSETS(ADS_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
)
ENGINE=InnoDB;

CREATE TABLE AD_STATS (
  STA_DATE_MILLIS BIGINT NOT NULL,
  STA_IMPRESSIONS BIGINT UNSIGNED NOT NULL,	  
  AD_ID BIGINT NOT NULL,
  PRIMARY KEY(STA_DATE_MILLIS, AD_ID),
  /*INDEX PRIMARY(STA_DATE_MILLIS, AD_ID),*/
  INDEX AD_STAT_FKIndex1(AD_ID),
  FOREIGN KEY(AD_ID)
    REFERENCES ADS(AD_ID)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
)
ENGINE=InnoDB;

/*INSERTS*/

INSERT INTO `CAMPAIGNS` (`CAM_ID`, `CAM_NAME`) VALUES
(1, 'campaign1'),
(2, 'campaign2'),
(3, 'campaign3');

INSERT INTO `ADSETS` (`ADS_ID`, `ADS_NAME`, `CAM_ID`) VALUES
(1, 'adset_1_1', 1),
(2, 'adset_2_1', 2),
(3, 'adset_3_1', 3);

INSERT INTO `ADS` (`AD_ID`, `AD_NAME`, `ADS_ID`) VALUES
(1, 'ad_1_1', 1),
(2, 'ad_2_1', 2),
(3, 'ad_3_1', 3);

INSERT INTO `AD_STATS` (`STA_DATE_MILLIS`, `STA_IMPRESSIONS`, `AD_ID`) VALUES
(111, 1, 1),
(111, 1, 2),
(222, 2, 1),
(222, 2, 2),
(333, 3, 1);